/* Cleaned stylesheet for E-Bloombilya
   - Restores layout consistency
   - Default lightstick/head/face sizes increased substantially (desktop)
   - Preserves fullscreen behavior and color swatches
*/
:root {
	--bg: #071226;
	--muted: #9aa4b2;
	--accent: #7c3aed;
	--light: #ffffff;
	--glow-size: 220px;
}

* {
	box-sizing: border-box;
}
html,
body {
	height: 100%;
}
body {
	margin: 0;
	/* avoid page scrollbars so the app truly feels fullscreen on mobile */
	overflow: hidden;
	font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue",
		Arial;
	background: linear-gradient(180deg, var(--bg), #04101a);
	color: #e6eef6;
	-webkit-font-smoothing: antialiased;
}

.container {
	max-width: 980px;
	/* remove default page margins so fullscreen layout doesn't create extra scroll */
	margin: 0;
	padding: 0;
	width: 100%;
	height: 100%;
}
.title {
	text-align: center;
	margin: 6px 0 16px;
	font-size: 1.25rem;
}

.light-area {
	display: flex;
	justify-content: center;
	align-items: center;
	padding: 0;
}

/* Default (desktop) — larger, prominent artwork */
.lightstick {
	/* fullscreen by default: occupy the viewport without needing a button */
	position: fixed;
	inset: 0;
	width: 100vw;
	height: calc(var(--vh, 1vh) * 100);
	display: flex;
	align-items: center;
	justify-content: center;
	z-index: 1;
}
.head {
	position: relative;
	/* keep the head large but not full-covering — ensure a reasonable minimum using clamp */
	width: clamp(340px, 82vmin, 900px);
	height: clamp(340px, 82vmin, 900px);
	border-radius: 12px;
	margin-top: 0;
	display: flex;
	align-items: center;
	justify-content: center;
	background: linear-gradient(
		180deg,
		rgba(255, 255, 255, 0.02),
		rgba(255, 255, 255, 0.01)
	);
	border: 1px solid rgba(255, 255, 255, 0.03);
	/* box-shadow: 0 12px 40px rgba(0, 0, 0, 0.45) inset; */
}
.face {
	width: 86%;
	height: 86%;
	border-radius: 50%;
	overflow: hidden;
	display: flex;
	align-items: center;
	justify-content: center;
	position: relative;
	background: transparent;
}
.face img {
	width: 100%;
	height: 100%;
	/* fill the circular face so artwork appears large on any viewport */
	object-fit: cover;
	display: block;
	z-index: 3;
	pointer-events: none;
	/* make the artwork slightly translucent so colored glow shines through */
	opacity: 0.86;
	mix-blend-mode: hard-light;
	transition: opacity 0.18s ease, filter 0.18s ease;
	filter: saturate(1.06) contrast(1.03);
}

/* Large glow for a stronger light effect */
.glow {
	position: absolute;
	/* base glow is large; we'll increase it further on small screens */
	width: 140vmin;
	height: 140vmin;
	left: 50%;
	top: 50%;
	transform: translate(-50%, -50%);
	border-radius: 50%;
	pointer-events: none;
	opacity: 0;
	transition: opacity 0.26s ease, box-shadow 0.26s ease, background 0.26s ease;
	filter: blur(84px);
	z-index: 2;
	mix-blend-mode: hard-light;
}
.glow.on {
	opacity: 1;
}

/* stronger, darker fullscreen-like glow on mobile — covers more area and is less blurry */
@media (max-width: 900px) {
	.glow {
		width: 200vmin;
		height: 200vmin;
		filter: blur(56px);
		transition: filter 0.2s ease, opacity 0.18s ease;
	}
	.glow.on {
		opacity: 50;
		/* make the glow feel denser on mobile */
		mix-blend-mode: hard-light;
	}
}

@media (max-width: 480px) {
	.glow {
		width: 240vmin;
		height: 240vmin;
		filter: blur(48px);
	}
	.glow.on {
		opacity: 50;
	}
}

/* Controls */
.controls {
	position: fixed;
	right: 14px;
	bottom: 14px;
	width: auto;
	max-width: 360px;
	max-height: 44vh;
	overflow: auto;
	background: rgba(6, 10, 20, 0.48);
	box-shadow: 0 10px 24px rgba(0, 0, 0, 0.45);
	backdrop-filter: blur(6px);
	border-radius: 12px;
	padding: 10px;
	z-index: 10010;
}
/* center controls content so modes/colors align centrally */
.controls {
	display: flex;
	flex-direction: column;
	align-items: center;
	text-align: center;
	gap: 8px;
}
.controls .row {
	display: flex;
	gap: 10px;
	justify-content: center;
	margin-bottom: 10px;
}
.btn {
	padding: 8px 12px;
	border-radius: 8px;
	border: 0;
	cursor: pointer;
	font-weight: 600;
	transition: transform 0.12s ease;
}
.btn:hover {
	transform: translateY(-3px);
}
.white {
	background: #fff;
	color: #111;
	border: 2px solid rgba(0, 0, 0, 0.08);
	box-shadow: 0 6px 18px rgba(0, 0, 0, 0.18);
}
.modes {
	display: flex;
	gap: 8px;
	align-items: center;
	justify-content: center;
	margin-bottom: 10px;
}
.mode {
	background: rgba(255, 255, 255, 0.03);
	color: var(--muted);
	border: 1px solid rgba(255, 255, 255, 0.06);
	padding: 6px 12px;
	border-radius: 999px;
	font-size: 0.92rem;
	cursor: pointer;
	transition: transform 0.12s ease, background 0.12s ease;
}
.mode:hover {
	transform: translateY(-3px);
	background: rgba(255, 255, 255, 0.06);
	color: #fff;
}
.mode.active {
	background: var(--accent);
	color: #fff;
	border-color: rgba(0, 0, 0, 0.12);
}
.mode-label {
	color: var(--muted);
	font-size: 0.95rem;
	margin-right: 6px;
}

/* Compact, attractive swatches */
.colors-grid {
	display: grid;
	/*grid-template-columns: repeat(auto-fit, minmax(44px, 1fr));*/
	grid-template-columns: repeat(5, minmax(0, 1fr));
	gap: 8px;
	padding: 6px;
	align-items: center;
	max-height: 34vh;
	overflow-y: auto;
}
.color-btn {
	width: 44px;
	height: 36px;
	padding: 3px;
	border-radius: 8px;
	border: 0;
	background: transparent;
	cursor: pointer;
	display: flex;
	align-items: center;
	justify-content: center;
	transition: transform 0.12s ease, box-shadow 0.12s ease;
}
.color-btn img {
	width: 100%;
	height: 100%;
	object-fit: cover;
	display: block;
	border-radius: 6px;
	box-shadow: 0 6px 16px rgba(0, 0, 0, 0.32);
}
.color-btn:hover {
	transform: translateY(-3px) scale(1.03);
}
.color-btn.selected {
	box-shadow: 0 10px 26px rgba(0, 0, 0, 0.55),
		0 0 0 3px rgba(255, 255, 255, 0.06);
}

.infinity {
	position: absolute;
	z-index: 6;
	left: 49%;
	top: 53%;
	transform: translate(-50%, -50%);
	width: 30px;
	height: 30px;
	border-radius: 50%;
	border: 0;
	background: radial-gradient(circle at 30% 28%, #fff6c6, #ffd24d);
	color: #ffcf33;
	display: flex;
	align-items: center;
	justify-content: center;
	font-size: 100%;
	box-shadow: 0 10px 30px rgba(255, 180, 50, 0.18),
		0 0 28px rgba(255, 200, 60, 0.12);
	cursor: pointer;
	pointer-events: auto;
}
.infinity::before {
	content: "★";
	color: #ffcf33;
	filter: drop-shadow(0 6px 18px rgba(255, 180, 40, 0.45));
}
.infinity:focus {
	outline: 2px solid rgba(255, 255, 255, 0.16);
}
.face.off img {
	filter: grayscale(70%) brightness(0.7);
	opacity: 0.6;
	mix-blend-mode: normal;
}
.hint {
	color: var(--muted);
	text-align: center;
	margin-top: 10px;
	font-size: 0.92rem;
}

/* Fullscreen behavior */
.is-full {
	background: #000 !important;
}
.is-full .container {
	max-width: none;
	padding: 0;
}
.title,
.hint {
	/* hidden by default since the app shows the lightstick fullscreen */
	display: none !important;
}
.is-full .lightstick {
	position: fixed;
	inset: 0;
	width: 100vw;
	/* use --vh to avoid mobile/iOS address bar shrinkage issues */
	height: calc(var(--vh, 1vh) * 100);
	margin: 0;
	display: flex;
	align-items: center;
	justify-content: center;
	z-index: 9999;
}
.is-full.fullscreen-expand .lightstick {
	background-image: url("images/bloombilya.png");
	background-size: cover;
	background-position: center;
	background-repeat: no-repeat;
}
.is-full.fullscreen-expand .face img {
	display: none;
}
.is-full.fullscreen-expand .head {
	width: 100vw !important;
	/* use --vh so fullscreen on iOS uses the true innerHeight */
	height: calc(var(--vh, 1vh) * 100) !important;
	border-radius: 0 !important;
}
.is-full .glow {
	z-index: 9998;
	opacity: 0;
}
.is-full .glow.on {
	opacity: 1;
}
.is-full.fullscreen-expand .glow {
	/* very large fullscreen glow; use --vh-based sizing for better mobile/iOS behavior */
	width: calc(var(--vh, 1vh) * 220) !important;
	height: calc(var(--vh, 1vh) * 220) !important;
	left: 50%;
	top: 50%;
	transform: translate(-50%, -50%);
	filter: blur(80px);
}

/* iOS-specific adjustments: reduce extreme vmax/vmin usage and rely on --vh */
.is-ios .glow {
	width: calc(var(--vh, 1vh) * 80) !important;
	height: calc(var(--vh, 1vh) * 80) !important;
	filter: blur(48px) !important;
}
.is-ios .is-full.fullscreen-expand .glow {
	width: calc(var(--vh, 1vh) * 140) !important;
	height: calc(var(--vh, 1vh) * 140) !important;
	filter: blur(64px) !important;
}
.is-full .controls {
	right: auto;
	left: 50%;
	transform: translateX(-50%);
	bottom: 28px;
	width: min(920px, 94%);
	max-width: 920px;
	padding: 12px 14px;
	border-radius: 14px;
	background: linear-gradient(
		180deg,
		rgba(0, 0, 0, 0.6),
		rgba(0, 0, 0, 0.28)
	);
}

/* Responsive caps */
@media (max-width: 900px) {
	/* keep fullscreen on mobile — scale the head down so it doesn't get covered */
	.lightstick {
		position: fixed;
		inset: 0;
		width: 100vw;
		height: calc(var(--vh, 1vh) * 100);
		display: flex;
		align-items: center;
		justify-content: center;
	}
	/* use vmin so the head scales to whichever dimension is smaller (portrait/landscape) */
	.head {
		width: clamp(320px, 86vmin, 92vw);
		height: clamp(320px, 86vmin, 92vw);
		border-radius: 12px;
	}
	.face {
		width: 88%;
		height: 88%;
	}
	.glow {
		width: 62vmin;
		height: 62vmin;
		filter: blur(48px);
	}
	/* center the controls container on smaller screens */
	.controls {
		left: 50%;
		right: auto;
		transform: translateX(-50%);
		width: min(92%, 720px);
		bottom: 12px;
	}
	/* make color grid 4 columns on medium/small screens */
	.colors-grid {
		grid-template-columns: repeat(5, minmax(0, 1fr));
		gap: 8px;
	}
}

@media (max-width: 640px) {
	.container {
		padding: 0;
	}
	.lightstick {
		position: fixed;
		inset: 0;
		width: 100vw;
		height: calc(var(--vh, 1vh) * 100);
		display: flex;
		align-items: center;
		justify-content: center;
	}
	/* make head large but bounded by viewport so it always fills available space */
	.head {
		width: clamp(300px, 88vmin, 96vw);
		height: clamp(300px, 88vmin, 96vw);
		border-radius: 10px;
	}
	.face {
		width: 100%;
		height: 200%;
	}
	.glow {
		width: 72vmin;
		height: 72vmin;
		filter: blur(44px);
	}
	.controls {
		left: 50%;
		right: auto;
		transform: translateX(-50%);
		width: min(94%, 760px);
		bottom: 10px;
		max-height: 38vh;
		padding: 8px;
		border-radius: 10px;
	}
	/* 3 columns on narrow screens so swatches don't get too small */
	.colors-grid {
		grid-template-columns: repeat(5, minmax(0, 1fr));
		gap: 6px;
	}
	:root {
		--glow-size: 140px;
	}
}

/* Keep controls accessible on desktop */
/* controls are defined earlier; duplicates removed */

/* Bigview fallback */
.bigview .container {
	max-width: none;
	padding: 0;
}
.bigview .title,
.bigview .controls {
	display: none;
}
.bigview .lightstick {
	display: flex;
	align-items: center;
	justify-content: center;
}
.bigview .head {
	width: min(60vmin, 85vw);
	height: min(60vmin, 85vw);
}
.bigview .glow {
	width: 120vmin;
	height: 120vmin;
}
